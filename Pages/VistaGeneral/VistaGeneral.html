<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Restaurante - Vista General</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    :root {
      --dorado: #e9c89a;
      --lavanda: #967ed5;
      --azul-profundo: #4e5d83;
      --rosa-pastel: #f5ddd3;
      --lavanda-claro: #bfbce9;
    }
    .bg-caos {
      background: linear-gradient(145deg, var(--azul-profundo), var(--lavanda));
    }
    .btn-caos {
      background-color: var(--lavanda);
      color: white;
      transition: background-color 0.3s;
    }
    .btn-caos:hover:not(:disabled) {
      background-color: var(--azul-profundo);
    }
    .title-caos {
      color: var(--dorado);
    }
    .panel-border {
      border: 1px solid var(--lavanda-claro);
    }
    .bar-fill {
      transition: width 0.5s ease-in-out;
    }
  </style>
</head>
<body class="bg-caos text-white font-sans min-h-screen flex flex-col">
  <!-- HEADER -->
  <header class="p-6 text-center">
    <img src="Capuzzela.jpg" alt="Logo" class="mx-auto w-24 mb-4" />
    <h1 class="text-3xl font-bold title-caos">Vista General</h1>
    <p class="text-sm mt-1 title-caos">LA CAPUZZELLE - SISTEMA DE ANÁLISIS OPERACIONAL</p>
    <div class="w-1/2 mx-auto mt-4">
      <label for="caosBar" class="text-sm block">Nivel de Caos Operacional</label>
      <div class="w-full h-4 bg-gray-700 rounded-full overflow-hidden">
        <div id="caosBar" class="h-full bg-yellow-400 bar-fill" style="width: 0%"></div>
      </div>
      <p class="text-right text-sm" id="caosValue">0%</p>
    </div>
    <div class="mt-4">
      <label for="numeroMesas" class="text-sm block">Seleccionar número de mesas (máx. 35):</label>
      <input type="number" id="numeroMesas" min="1" max="35" class="p-2 rounded bg-gray-900 text-white">
      <button onclick="generarMesas()" class="btn-caos p-2 rounded ml-2">Generar Mesas</button>
    </div>
  </header>
  <!-- CONTENIDO PRINCIPAL -->
  <main class="grid grid-cols-5 gap-4 p-6 flex-grow">
    <!-- BARRA LATERAL -->
    <aside class="bg-gray-900 rounded-xl p-4 panel-border">
      <h2 class="text-xl font-semibold text-lavanda">Cola de Espera</h2>
      <div id="colaEspera" class="mt-4 space-y-2">
        <!-- Aquí se mostrarán los clientes en espera -->
      </div>
    </aside>
    <!-- CONTENIDO PRINCIPAL -->
    <section class="col-span-4 bg-gray-800 rounded-xl p-4 panel-border flex flex-col space-y-4">
      <!-- PRIMERA LINEA DE CUADROS -->
      <div class="grid grid-cols-5 gap-4">
        <div class="bg-gray-700 rounded-xl p-4 text-center">
          <p class="text-sm">Tiempo Promedio</p>
          <p id="tiempoPromedio" class="text-xl font-bold">0 min</p>
        </div>
        <div class="bg-gray-700 rounded-xl p-4 text-center">
          <p class="text-sm">Satisfacción</p>
          <p id="satisfaccion" class="text-xl font-bold">0%</p>
        </div>
        <div class="bg-gray-700 rounded-xl p-4 text-center">
          <p class="text-sm">Órdenes Retrasadas</p>
          <p id="ordenesRetrasadas" class="text-xl font-bold">0</p>
        </div>
        <div class="bg-gray-700 rounded-xl p-4 text-center">
          <p class="text-sm">Clientes Perdidos</p>
          <p id="clientesPerdidos" class="text-xl font-bold">0</p>
        </div>
        <div class="bg-gray-700 rounded-xl p-4 text-center">
          <p class="text-sm">En Cola</p>
          <p id="enCola" class="text-xl font-bold">0</p>
        </div>
      </div>
      <!-- ESTADO DE MESA -->
      <div class="bg-gray-700 rounded-xl p-4">
        <h2 class="text-xl font-semibold text-lavanda">Estado de Mesa</h2>
        <div id="estadoMesas" class="grid grid-cols-4 gap-4 mt-4">
          <!-- Mesas generadas dinámicamente -->
        </div>
      </div>
      <!-- PERSONAL -->
      <div class="bg-gray-700 rounded-xl p-4">
        <h2 class="text-xl font-semibold text-lavanda">Personal</h2>
        <div class="grid grid-cols-4 gap-4 mt-4">
          <!-- Personal -->
          <div class="bg-gray-800 rounded-xl p-4">
            <p class="text-sm">Valentina – Camarera</p>
            <select class="mt-2 p-1 rounded bg-gray-900" onchange="cambiarEstadoPersonal('Valentina', this.value)">
              <option value="descanso">En descanso</option>
              <option value="abrumado">Abrumado</option>
              <option value="ocupado">Ocupado</option>
            </select>
            <p class="text-sm">Porcentaje: <span id="porcentaje-Valentina" class="porcentaje-personal">0%</span></p>
          </div>
          <div class="bg-gray-800 rounded-xl p-4">
            <p class="text-sm">Mateo – Camarero</p>
            <select class="mt-2 p-1 rounded bg-gray-900" onchange="cambiarEstadoPersonal('Mateo', this.value)">
              <option value="descanso">En descanso</option>
              <option value="abrumado">Abrumado</option>
              <option value="ocupado">Ocupado</option>
            </select>
            <p class="text-sm">Porcentaje: <span id="porcentaje-Mateo" class="porcentaje-personal">0%</span></p>
          </div>
          <div class="bg-gray-800 rounded-xl p-4">
            <p class="text-sm">Isabella – Camarera</p>
            <select class="mt-2 p-1 rounded bg-gray-900" onchange="cambiarEstadoPersonal('Isabella', this.value)">
              <option value="descanso">En descanso</option>
              <option value="abrumado">Abrumado</option>
              <option value="ocupado">Ocupado</option>
            </select>
            <p class="text-sm">Porcentaje: <span id="porcentaje-Isabella" class="porcentaje-personal">0%</span></p>
          </div>
          <div class="bg-gray-800 rounded-xl p-4">
            <p class="text-sm">Santiago – Camarero</p>
            <select class="mt-2 p-1 rounded bg-gray-900" onchange="cambiarEstadoPersonal('Santiago', this.value)">
              <option value="descanso">En descanso</option>
              <option value="abrumado">Abrumado</option>
              <option value="ocupado">Ocupado</option>
            </select>
            <p class="text-sm">Porcentaje: <span id="porcentaje-Santiago" class="porcentaje-personal">0%</span></p>
          </div>
          <div class="bg-gray-800 rounded-xl p-4">
            <p class="text-sm">Camila – Camarera</p>
            <select class="mt-2 p-1 rounded bg-gray-900" onchange="cambiarEstadoPersonal('Camila', this.value)">
              <option value="descanso">En descanso</option>
              <option value="abrumado">Abrumado</option>
              <option value="ocupado">Ocupado</option>
            </select>
            <p class="text-sm">Porcentaje: <span id="porcentaje-Camila" class="porcentaje-personal">0%</span></p>
          </div>
          <div class="bg-gray-800 rounded-xl p-4">
            <p class="text-sm">Lucas – Camarero</p>
            <select class="mt-2 p-1 rounded bg-gray-900" onchange="cambiarEstadoPersonal('Lucas', this.value)">
              <option value="descanso">En descanso</option>
              <option value="abrumado">Abrumado</option>
              <option value="ocupado">Ocupado</option>
            </select>
            <p class="text-sm">Porcentaje: <span id="porcentaje-Lucas" class="porcentaje-personal">0%</span></p>
          </div>
          <div class="bg-gray-800 rounded-xl p-4">
            <p class="text-sm">Emilia – Jefa de Cocina</p>
            <select class="mt-2 p-1 rounded bg-gray-900" onchange="cambiarEstadoPersonal('Emilia', this.value)">
              <option value="descanso">En descanso</option>
              <option value="abrumado">Abrumado</option>
              <option value="ocupado">Ocupado</option>
            </select>
            <p class="text-sm">Porcentaje: <span id="porcentaje-Emilia" class="porcentaje-personal">0%</span></p>
          </div>
          <div class="bg-gray-800 rounded-xl p-4">
            <p class="text-sm">Diego – Cocinero</p>
            <select class="mt-2 p-1 rounded bg-gray-900" onchange="cambiarEstadoPersonal('Diego', this.value)">
              <option value="descanso">En descanso</option>
              <option value="abrumado">Abrumado</option>
              <option value="ocupado">Ocupado</option>
            </select>
            <p class="text-sm">Porcentaje: <span id="porcentaje-Diego" class="porcentaje-personal">0%</span></p>
          </div>
          <div class="bg-gray-800 rounded-xl p-4">
            <p class="text-sm">Sofía – Cocinera</p>
            <select class="mt-2 p-1 rounded bg-gray-900" onchange="cambiarEstadoPersonal('Sofía', this.value)">
              <option value="descanso">En descanso</option>
              <option value="abrumado">Abrumado</option>
              <option value="ocupado">Ocupado</option>
            </select>
            <p class="text-sm">Porcentaje: <span id="porcentaje-Sofía" class="porcentaje-personal">0%</span></p>
          </div>
          <div class="bg-gray-800 rounded-xl p-4">
            <p class="text-sm">Benjamín – Ayudante de Cocina</p>
            <select class="mt-2 p-1 rounded bg-gray-900" onchange="cambiarEstadoPersonal('Benjamín', this.value)">
              <option value="descanso">En descanso</option>
              <option value="abrumado">Abrumado</option>
              <option value="ocupado">Ocupado</option>
            </select>
            <p class="text-sm">Porcentaje: <span id="porcentaje-Benjamín" class="porcentaje-personal">0%</span></p>
          </div>
          <div class="bg-gray-800 rounded-xl p-4">
            <p class="text-sm">Renata – Ayudante de Cocina</p>
            <select class="mt-2 p-1 rounded bg-gray-900" onchange="cambiarEstadoPersonal('Renata', this.value)">
              <option value="descanso">En descanso</option>
              <option value="abrumado">Abrumado</option>
              <option value="ocupado">Ocupado</option>
            </select>
            <p class="text-sm">Porcentaje: <span id="porcentaje-Renata" class="porcentaje-personal">0%</span></p>
          </div>
          <div class="bg-gray-800 rounded-xl p-4">
            <p class="text-sm">Tomás – Ayudante de Cocina</p>
            <select class="mt-2 p-1 rounded bg-gray-900" onchange="cambiarEstadoPersonal('Tomás', this.value)">
              <option value="descanso">En descanso</option>
              <option value="abrumado">Abrumado</option>
              <option value="ocupado">Ocupado</option>
            </select>
            <p class="text-sm">Porcentaje: <span id="porcentaje-Tomás" class="porcentaje-personal">0%</span></p>
          </div>
        </div>
      </div>
      <!-- ACTIVIDAD DE COCINA -->
      <div class="bg-gray-700 rounded-xl p-4">
        <h2 class="text-xl font-semibold text-lavanda">Actividad de Cocina</h2>
        <div id="actividadCocina" class="grid grid-cols-4 gap-4 mt-4">
          <!-- Actividades de cocina generadas dinámicamente -->
        </div>
      </div>
      <!-- ACCIONES DE EMERGENCIA -->
      <div class="bg-gray-700 rounded-xl p-4">
        <h2 class="text-xl font-semibold text-lavanda">Acciones de Emergencia</h2>
        <div class="grid grid-cols-4 gap-4 mt-4">
          <button onclick="llamarMasPersonal()" class="bg-purple-500 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded">
            Llamar más Personal
          </button>
          <button onclick="ofrecerDescuento()" class="bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded">
            Ofrecer Descuento
          </button>
          <button onclick="cerrarCocina()" class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">
            Cerrar Cocina
          </button>
          <button onclick="activarModoCrisis()" class="bg-orange-500 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded">
            Activar Modo Crisis
          </button>
        </div>
      </div>
    </section>
  </main>
  <script>
    // Función para mostrar mensajes
    function mostrarMensaje(mensaje) {
      const mensajeElement = document.getElementById('mensaje');
      mensajeElement.textContent = mensaje;
      mensajeElement.style.display = 'block';
      setTimeout(() => {
        mensajeElement.style.display = 'none';
      }, 3000);
    }

    // Función para generar mesas dinámicamente
    function generarMesas() {
      const numeroMesas = parseInt(document.getElementById('numeroMesas').value);
      if (isNaN(numeroMesas) || numeroMesas < 1 || numeroMesas > 35) {
        alert("Por favor, ingresa un número válido de mesas (1-35).");
        return;
      }

      const estadoMesasDiv = document.getElementById('estadoMesas');
      estadoMesasDiv.innerHTML = '';

      const actividadCocinaDiv = document.getElementById('actividadCocina');
      actividadCocinaDiv.innerHTML = '';

      for (let i = 1; i <= numeroMesas; i++) {
        // Generar mesas
        const mesaDiv = document.createElement('div');
        mesaDiv.className = 'bg-gray-800 rounded-xl p-4';
        mesaDiv.innerHTML = `
          <p class="text-sm font-bold">Mesa ${i}</p>
          <p class="text-sm">Ubicación: ${obtenerUbicacionAleatoria()}</p>
          <p class="text-sm">Asientos: ${Math.floor(Math.random() * 8) + 1}</p>
          <p class="text-sm">${obtenerCalificacionAleatoria()}</p>
          <p class="text-xs">${obtenerDescripcionAleatoria()}</p>
          <select class="mt-2 p-1 rounded bg-gray-900" onchange="cambiarEstadoMesa(${i}, this.value)">
            <option value="" disabled selected>Seleccionar...</option>
            <option value="libre">Libre</option>
            <option value="ocupado">Ocupado</option>
          </select>
        `;
        estadoMesasDiv.appendChild(mesaDiv);

        // Generar actividad de cocina
        const actividadDiv = document.createElement('div');
        actividadDiv.className = 'bg-gray-800 rounded-xl p-4';
        actividadDiv.innerHTML = `
          <p class="text-sm font-bold">Mesa ${i}</p>
          <p class="text-sm">Tiempo: <span id="tiempo-mesa-${i}">${Math.floor(Math.random() * 30) + 1}</span> min</p>
          <p class="text-sm">Estado: <span id="estado-mesa-${i}">${Math.random() > 0.5 ? 'Cocinando' : 'Listo'}</span></p>
        `;
        actividadCocinaDiv.appendChild(actividadDiv);
      }
    }

    function obtenerUbicacionAleatoria() {
      const ubicaciones = ["Ventana", "Central", "Esquina acogedora", "Terraza", "VIP", "Cerca del bar", "Familiar grande", "Pasillo", "Sofá Lounge"];
      return ubicaciones[Math.floor(Math.random() * ubicaciones.length)];
    }

    function obtenerCalificacionAleatoria() {
      const calificaciones = ["⭐⭐⭐⭐⭐", "⭐⭐⭐⭐☆", "⭐⭐⭐☆☆", "⭐⭐☆☆☆", "⭐☆☆☆☆"];
      return calificaciones[Math.floor(Math.random() * calificaciones.length)];
    }

    function obtenerDescripcionAleatoria() {
      const descripciones = [
        "Buena luz natural, ideal para parejas o familias pequeñas.",
        "Romántica, perfecta para una cita.",
        "Algo ruidosa, pero buena para grupos.",
        "Tránsito medio, ubicación estándar.",
        "Muy íntima, ideal para charlas privadas.",
        "Buen clima, vista agradable (si el clima lo permite).",
        "Perfecta para grupos al aire libre.",
        "Reservada, más tranquila y privada.",
        "Ruidosa pero conveniente para clientes sociales.",
        "Ideal para familias o celebraciones.",
        "Menos privada, algo incómoda por el paso constante.",
        "Casual, cómoda, perfecta para café o postres."
      ];
      return descripciones[Math.floor(Math.random() * descripciones.length)];
    }

    // Función para actualizar la cola de espera
    function actualizarColaEspera() {
      const colaEspera = document.getElementById('colaEspera');
      colaEspera.innerHTML = '';
      // Generar clientes aleatorios
      const clientes = [
        { numero: 1, personas: 4, tiempo: 5 },
        { numero: 2, personas: 2, tiempo: 15 },
        { numero: 3, personas: 3, tiempo: 25 },
        { numero: 4, personas: 5, tiempo: 35 },
      ];
      clientes.forEach(cliente => {
        let emoji, color;
        if (cliente.tiempo > 25) {
          emoji = '😡';
          color = 'text-red-500';
        } else if (cliente.tiempo >= 15) {
          emoji = '😞';
          color = 'text-yellow-500';
        } else {
          emoji = '😊';
          color = 'text-green-500';
        }
        colaEspera.innerHTML += `
          <div class="flex justify-between items-center p-2 bg-gray-800 rounded">
            <span>Cliente ${cliente.numero}</span>
            <span>${cliente.personas} personas</span>
            <span class="${color}">${emoji} ${cliente.tiempo} min</span>
          </div>
        `;
      });
    }

    // Función para agregar un nuevo cliente a la cola de espera
    function agregarClienteAleatorio() {
      const colaEspera = document.getElementById('colaEspera');
      const numeroCliente = colaEspera.children.length + 1;
      const personas = Math.floor(Math.random() * 4) + 1;
      const tiempo = Math.floor(Math.random() * 40) + 1;
      let emoji, color;
      if (tiempo > 25) {
        emoji = '😡';
        color = 'text-red-500';
      } else if (tiempo >= 15) {
        emoji = '😞';
        color = 'text-yellow-500';
      } else {
        emoji = '😊';
        color = 'text-green-500';
      }
      colaEspera.innerHTML += `
        <div class="flex justify-between items-center p-2 bg-gray-800 rounded">
          <span>Cliente ${numeroCliente}</span>
          <span>${personas} personas</span>
          <span class="${color}">${emoji} ${tiempo} min</span>
        </div>
      `;
      // Actualizar la cantidad de personas en cola
      actualizarEnCola();
    }

    // Función para actualizar el tiempo promedio
    function actualizarTiempoPromedio() {
      const tiempos = Array.from(document.querySelectorAll('#colaEspera span:last-child')).map(span => {
        const tiempo = parseInt(span.textContent.match(/\d+/)[0]);
        return tiempo;
      });
      const tiempoPromedio = tiempos.reduce((a, b) => a + b, 0) / tiempos.length;
      document.getElementById('tiempoPromedio').textContent = `${isNaN(tiempoPromedio) ? 0 : tiempoPromedio.toFixed(0)} min`;
    }

    // Función para actualizar la satisfacción
    function actualizarSatisfaccion() {
      const clientes = Array.from(document.querySelectorAll('#colaEspera span:last-child'));
      const clientesFelices = clientes.filter(span => {
        const tiempo = parseInt(span.textContent.match(/\d+/)[0]);
        return tiempo < 15;
      }).length;
      const satisfaccion = (clientesFelices / clientes.length) * 100;
      document.getElementById('satisfaccion').textContent = `${isNaN(satisfaccion) ? 0 : satisfaccion.toFixed(0)}%`;
    }

    // Función para actualizar las órdenes retrasadas
    function actualizarOrdenesRetrasadas() {
      const ordenesRetrasadas = 3; // Valor aleatorio
      document.getElementById('ordenesRetrasadas').textContent = ordenesRetrasadas;
    }

    // Función para actualizar los clientes perdidos
    function actualizarClientesPerdidos() {
      const clientesPerdidos = 1; // Valor aleatorio
      document.getElementById('clientesPerdidos').textContent = clientesPerdidos;
    }

    // Función para actualizar la cantidad de personas en cola
    function actualizarEnCola() {
      const enCola = document.querySelectorAll('#colaEspera div').length;
      document.getElementById('enCola').textContent = enCola;
    }

    // Función para cambiar el estado de una mesa
    function cambiarEstadoMesa(numeroMesa, estado) {
      const estadoElement = document.getElementById(`estado-mesa-${numeroMesa}`);
      if (estadoElement) {
        estadoElement.textContent = estado === 'libre' ? 'Listo' : 'Cocinando';
      }
      if (estado === 'libre') {
        const colaEspera = document.getElementById('colaEspera');
        if (colaEspera.children.length > 0) {
          const primerCliente = colaEspera.children[0];
          const clienteInfo = primerCliente.querySelectorAll('span');
          mostrarMensaje(`Cliente ${clienteInfo[0].textContent} sentado en la Mesa ${numeroMesa}`);
          colaEspera.removeChild(primerCliente);
          actualizarEnCola();
        }
      }
    }

    // Función para cambiar el estado del personal
    function cambiarEstadoPersonal(nombre, estado) {
      const porcentajeElement = document.getElementById(`porcentaje-${nombre}`);
      let porcentaje;
      switch(estado) {
        case 'descanso':
          porcentaje = 0;
          break;
        case 'abrumado':
          porcentaje = Math.floor(Math.random() * 30) + 70; // 70-100%
          break;
        case 'ocupado':
          porcentaje = Math.floor(Math.random() * 40) + 30; // 30-70%
          break;
      }
      porcentajeElement.textContent = `${porcentaje}%`;
    }

    // Funciones para acciones de emergencia
    function llamarMasPersonal() {
      const selectsPersonal = document.querySelectorAll('.bg-gray-800 select');
      selectsPersonal.forEach(select => {
        if (select.value === 'descanso') {
          select.value = 'ocupado';
          const nombre = select.parentElement.querySelector('p').textContent.split(' – ')[0];
          cambiarEstadoPersonal(nombre, 'ocupado');
        }
      });
      alert("Personal en descanso llamado a trabajar.");
    }

    function ofrecerDescuento() {
      const clientes = document.querySelectorAll('#colaEspera div span:last-child');
      clientes.forEach(cliente => {
        cliente.classList.remove('text-yellow-500', 'text-red-500');
        cliente.classList.add('text-green-500');
        cliente.textContent = '😊 5 min';
      });
      alert("Descuento ofrecido. Todos los clientes están felices.");
    }

    function cerrarCocina() {
      const confirmar = confirm("¿Estás seguro de que deseas cerrar la cocina?");
      if (confirmar) {
        alert("La cocina está cerrada. Reiniciando el sistema...");
        // Aquí puedes agregar la lógica para reiniciar el sistema
      }
    }

    function activarModoCrisis() {
      const selectsPersonal = document.querySelectorAll('.bg-gray-800 select');
      selectsPersonal.forEach(select => {
        select.value = 'abrumado';
        const nombre = select.parentElement.querySelector('p').textContent.split(' – ')[0];
        cambiarEstadoPersonal(nombre, 'abrumado');
      });
      const selectsMesas = document.querySelectorAll('.bg-gray-800 select');
      selectsMesas.forEach(select => {
        select.value = 'ocupado';
        const numeroMesa = select.parentElement.querySelector('p.text-sm.font-bold').textContent.split(' ')[1];
        cambiarEstadoMesa(parseInt(numeroMesa), 'ocupado');
      });
      const clientes = document.querySelectorAll('#colaEspera div span:last-child');
      clientes.forEach(cliente => {
        cliente.classList.remove('text-yellow-500', 'text-green-500');
        cliente.classList.add('text-red-500');
        cliente.textContent = '😡 35 min';
      });
      alert("Modo crisis activado. Todo el personal está abrumado, todas las mesas están ocupadas y los clientes están molestos.");
    }

    // Llamar a las funciones para actualizar la información
    actualizarColaEspera();
    actualizarTiempoPromedio();
    actualizarSatisfaccion();
    actualizarOrdenesRetrasadas();
    actualizarClientesPerdidos();
    actualizarEnCola();

    // Agregar un nuevo cliente cada 5 segundos
    setInterval(agregarClienteAleatorio, 5000);

    // Actualizar tiempo promedio y satisfacción cada 10 segundos
    setInterval(actualizarTiempoPromedio, 10000);
    setInterval(actualizarSatisfaccion, 10000);
  </script>
</body>
</html>
